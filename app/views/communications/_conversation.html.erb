<body>

<style>

* {
     margin: 0;
     padding: 0;
     font-family: tahoma, sans-serif;
     box-sizing: border-box;


}

body{
     background: lightblue;

}
.chatbox{
     width: 500px;
     min-width: 390px;
     height: 600px;
     background: white;
     padding: 25px;
     margin: 20px auto;
     box-shadow: 0 3px grey;

}


.chatlog{
     padding: 10px;
     width: 100%;
     height: 450px;

}
.chat{
     display: flex;
     flex-flow: row wrap;
     align-items: flex-start;
     margin-bottom: 10px;
}

.chat .user-photo{
     width: 60px;
     height: 60px;
     background: white;
     border-radius: 50%;
}

.chat .chat-message{
     width:80%;
     padding: 15px;
     margin: 5px 10px 0;
     background: blue;
     border-radius: 10px;
     color: white;
     font-size: 18px;
}
.friend .chat-message{
     background: blue;
}

.self .chat-message{
     background: green;
     order: -1;

}
</style>





<div class= "chatbox">

     <div class= "chatlog">
          <% if Communication.all.empty?%>

          <% else %>

          <% Communication.all.each do |communication|  %>
               <% if conversation.user1.email == communication.sender.email%>
                    <% if conversation.user2.email == communication.reciever.email%>
                         <div class= "chat self">
                              <div class= "user-photo">
                              <%= communication.sender.email %>
                              </div>
                              <p class= "chat-message">
                                   <%= communication.message.message %></p>
                         </div>
                    <% end %>


                    <% elsif conversation.user1.email == communication.reciever.email%>
                         <% if conversation.user2.email == communication.sender.email%>
                         <div class= "chat friend">
                                <div class= "user-photo">
                                     <%= communication.sender.email %>
                                </div>
                                <p class= "chat-message">
                                     <%= communication.message.message %>
                                </p>
                           </div>
                           <% end %>

               <% end %>

            <% end %>
            <% end %>


     </div>



     <%= link_to "Create a New Message", new_communication_path %>



</body>
